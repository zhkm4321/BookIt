<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>${siteName} - 桌面管理</title>
<link href="${codeBase}/res/frame/css/public.css" type="text/css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="${codeBase}/res/css/reset.css" media="all" />
<link rel="stylesheet" type="text/css" href="${codeBase}/res/css/global.css" media="all" />	
<link rel="stylesheet" type="text/css" href="${codeBase}/res/css/common.css" media="all" />
<script src="${codeBase}/res/scripts/dateFormat.js" type="text/javascript"></script>
<script src="${codeBase}/res/scripts/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="${codeBase}/thirdparty/highcharts/highcharts.js" type="text/javascript"></script>
<script src="${codeBase}/thirdparty/highcharts/modules/exporting.js" type="text/javascript"></script>
<script src="${codeBase}/thirdparty/highcharts/modules/data.js" type="text/javascript"></script>
<script src="${codeBase}/thirdparty/highcharts/modules/drilldown.js" type="text/javascript"></script>
<script type="text/javascript">
var codeBase='${codeBase}';
function get_height(){
	var page_height = document.documentElement.clientHeight;
	var head_height = document.getElementById('pageHead').clientHeight;
	document.getElementById('right_con').style.height = (page_height - head_height)+'px';
}

window.onload = get_height;
window.onresize = get_height;


$(function () {
	var drilldownSeries,brandsData;
	$.getJSON("${codeBase}/stati/countChart.html",function(data){
		brandsData=data.brandsData;
		drilldownSeries=data.drilldownSeries;
	    $("#countChartContainer").highcharts({
	    // Create the chart
		    chart: {
		        type: 'column'
		    },
		    title: {
		        text: ''
		    },
		    subtitle: {
		        text: '截止日期'+new Date().Format("yyyy年月MM月dd日 hh:mm:ss"),
		        x:30
		    },
		    xAxis: {
		        type: 'category'
		    },
		    yAxis: {
		        title: {
		            text: '上传数量'
		        }
		    },
		    legend: {
		        enabled: false
		    },
		    plotOptions: {
		        series: {
		            borderWidth: 0,
		            dataLabels: {
		                enabled: true,
		                formatter : function() {//设置纵坐标值的样式
		                	return this.y + '个';
		                }
		            }
		        }
		    },
			credits:{
				text:"UED组件库",
				href:"http://ued.thunisoft.com/cookit"
			},
		    tooltip: {
		        headerFormat: '',
		        pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y}个</b><br/>'
		    },
		
		    series: [{
		        name: '组件分类',
		        colorByPoint: true,
		        data: brandsData
		    }],
		    drilldown: {
		        series: drilldownSeries
		    }
		});
	});
	$.getJSON("${codeBase}/stati/downChart.html",function(data){
		brandsData=data.brandsData;
		drilldownSeries=data.drilldownSeries;
	    $("#downChartContainer").highcharts({
	    // Create the chart
		    chart: {
		        type: 'column'
		    },
		    title: {
		        text: ''
		    },
		    subtitle: {
		        text: '截止日期'+new Date().Format("yyyy年月MM月dd日 hh:mm:ss"),
		        x:30
		    },
		    xAxis: {
		        type: 'category'
		    },
		    yAxis: {
		        title: {
		            text: '下载次数'
		        }
		    },
		    legend: {
		        enabled: false
		    },
		    plotOptions: {
		        series: {
		            borderWidth: 0,
		            dataLabels: {
		                enabled: true,
		                formatter : function() {//设置纵坐标值的样式
		                	return this.y + '次';
		                }
		            }
		        }
		    },
			credits:{
				text:"UED组件库",
				href:"http://ued.thunisoft.com/cookit"
			},
		    tooltip: {
		        headerFormat: '',//<span style="font-size:11px">{series.name}</span><br>
		        pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y}次</b><br/>'
		    },
		
		    series: [{
		        name: '组件分类',
		        colorByPoint: true,
		        data: brandsData
		    }],
		    drilldown: {
		        series: drilldownSeries
		    }
		});
	});
});
</script>
<style>
	body,html {
			overflow:hidden;
		}
	#right_con{
		overflow: auto;
	}
</style>
</head>

<body>
<div class="wrap">
	<div class="header" id="pageHead">
		<div class="logo"></div>
		<div class="user">
			您好：${user.realname}&nbsp;&nbsp;
			<a href="${codeBase}/admin/logout.do">退出</a>
		</div>
		<ul class="top_nav">
			<li id="tb_select">
				<a href="${codeBase}/admin/index.html">组件管理</a>
			</li>
			<li id="xt_select" class="select">
				<a href="${codeBase}/stati/index.html">统计数据</a>
			</li>
		</ul>
	</div>
    <div class="clear"></div>
    <div id="right_con">
    	<div class="contain_static_backstage">
			<section>
				<h2 class="h2_30_m"><span class="sp_title">下载总数 ${total}</span></h2>
				<h2 class="h2_24_m">TOP10</h2>
				<ul class="ul_rank">
				[#list orderList as item]
					[#if item_index==0]
					<li  class="li_first">
						<div class="d_num">${item_index+1}</div>
						<div class="d_img">
							<img src="${codeBase}${item.imgPath!}" alt="${item.name}" />
							<p>${item.templateCategory.parent.name}-${item.templateCategory.name}<br />${item.name}</p>
						</div>
						<div class="d_progress">
							<div class="current_progress" style="width:${item.percent}%;"><span class="sp_count">${item.downloadCount}</span></div>
						</div>
					</li>
					[#elseif item_index==1]
					<li class="li_second">
						<div class="d_num">${item_index+1}</div>
						<div class="d_img">
							<img src="${codeBase}${item.imgPath!}" alt="${item.name}" />
							<p>${item.templateCategory.parent.name}-${item.templateCategory.name}<br />${item.name}</p>
						</div>
						<div class="d_progress">
							<div class="current_progress" style="width:${item.percent}%;"><span class="sp_count">${item.downloadCount}</span></div>
						</div>
					</li>
					[#elseif item_index==2]
					<li class="li_third">
						<div class="d_num">${item_index+1}</div>
						<div class="d_img">
							<img src="${codeBase}${item.imgPath!}" alt="${item.name}" />
							<p>${item.templateCategory.parent.name}-${item.templateCategory.name}<br />${item.name}</p>
						</div>
						<div class="d_progress">
							<div class="current_progress" style="width:${item.percent}%;"><span class="sp_count">${item.downloadCount}</span></div>
						</div>
					</li>
					[#else]
					<li>
						<div class="d_num">${item_index+1}</div>
						<div class="d_img">
							<img src="${codeBase}${item.imgPath!}" alt="${item.name}" />
							<p>${item.templateCategory.parent.name}-${item.templateCategory.name}<br />${item.name}</p>
						</div>
						<div class="d_progress">
							<div class="current_progress" style="width:${item.percent}%;"><span class="sp_count">${item.downloadCount}</span></div>
						</div>
					</li>
					[/#if]
				[/#list]
				</ul>
			</section>
			<section>
				<h2 class="h2_30_m"><span class="sp_title">下载分类统计</span></h2>
				<div class="layer">
						<figure class="figure_chart">
							 <div id="downChartContainer" class="chart"></div>
						</figure>
				</div>
				<h2 class="h2_30_m"><span class="sp_title">组件数量共计 ${templateCount!}</span></h2>
				<div class="layer">
						<figure class="figure_chart">
							 <div id="countChartContainer" class="chart"></div>
						</figure>
				</div>
			</section>
		</div>
	</div>
</div>
</body>
</html>